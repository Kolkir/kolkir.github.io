<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:og="http://ogp.me/ns#"
      xmlns:fb="https://www.facebook.com/2008/fbml">
<head>
    <title>Python script to automate VC++ build</title>
    <!-- Using the latest rendering mode for IE -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Open Graph tags -->

            <meta property="og:type" content="article"/>
            <meta property="og:title" content="Python script to automate VC++ build"/>
            <meta property="og:url" content="./python-script-to-automate-vc-build.html"/>
            <meta property="og:description" content="Here is example of the Python script which can be used to automate VC++ compilation and build process. It sequentially build VC Solutions and write short results to console window. If there were errors during compilation it will show them(only errors) and asks about continuing general build process. buildDirDebug ..."/>

    <!-- Bootstrap -->
        <link rel="stylesheet" href="./theme/css/bootstrap.min.css" type="text/css"/>
    <link href="./theme/css/font-awesome.min.css" rel="stylesheet">
    <link href="./theme/css/pygments.css" rel="stylesheet">
    <link rel="stylesheet" href="./theme/css/style.css" type="text/css"/>
    <!-- JavaScript plugins (requires jQuery) -->
    <script src="http://code.jquery.com/jquery.js"></script>

        <link href="./feeds\all.atom.xml" type="application/atom+xml" rel="alternate"
              title="C-Vision ATOM Feed"/>
        <link href="./feeds/all.rss.xml" type="application/atom+xml" rel="alternate"
              title="C-Vision RSS Feed"/>

</head>
<body>
<nav class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a href="." class="navbar-brand">C-Vision</a>
        </div>
        <div class="collapse navbar-collapse navbar-ex1-collapse">
            <ul class="nav navbar-nav">
                        <li><a href="./pages/about-me.html">About me</a></li>
                        <li><a href="./pages/camera-calibration.html">Camera calibration</a></li>
                        <li><a href="./pages/dicom-to-stl.html">DICOM to STL</a></li>
                        <li><a href="./pages/multithreadingc.html">Multithreading(C++)</a></li>
                        <li class="active">
                            <a href="./category/programming.html">Programming</a>
                        </li>
            </ul>
            <ul class="nav navbar-nav navbar-right">
                <li><a href="./archives.html"><i class="icon-th-list"></i>Archives</a></li>
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
</nav>
<!-- /.navbar -->
<div class="container">
    <div class="row">
        <div class="col-lg-9">
    <section id="content">
        <article>
            <header class="page-header">
                <h1>
                    <a href="./python-script-to-automate-vc-build.html"
                       rel="bookmark"
                       title="Permalink to Python script to automate VC++ build">
                        Python script to automate VC++ build
                    </a>
                </h1>
            </header>
            <div class="entry-content">
                <div class="panel">
                    <div class="panel-body">
<footer class="post-info">
    <span class="label label-default">Date</span>
    <span class="published">
        <i class="icon-calendar"></i>Fri 21 December 2012
    </span>



</footer><!-- /.post-info -->                    </div>
                </div>
                <p>Here is example of the Python script which can be used to automate VC++
compilation and build process. It sequentially build VC Solutions and
write short results to console window. If there were errors during
compilation it will show them(only errors) and asks about continuing
general build process.</p>
<pre class="literal-block">
buildDirDebug    = &quot;D:\\development\\Debug&quot;
buildDirRelease  = &quot;D:\\development\\Release&quot;

binaryDir = &quot;SourceCode\\Bin&quot;
codeDir   = &quot;SourceCode&quot;
devenv    = &quot;\&quot;C:\\Program Files (x86)\\Microsoft Visual Studio 10.0\\Common7\\IDE\\devenv.com\&quot;&quot;
logFile   = &quot;build.log&quot;

# path relative to &quot;codeDir&quot;
solutions = [
&quot;Proj1\solution1.sln&quot;,
&quot;Proj2\solution2.sln&quot;,
&quot;Proj3\solution3.sln&quot;,
]

buildModeDebug   = &quot;Debug&quot;
buildModeRelease = &quot;Release&quot;

#------------------------------------------------------------------------------------------------------

import sys
import subprocess
from threading  import Thread
from Queue import Queue, Empty
import colorama
from colorama import Fore, Back, Style

buildDir  = buildDirDebug
buildMode = buildModeDebug

answer = raw_input('Debug/Release?[d/r]:')
if answer.lower() == &quot;r&quot;:
    buildDir  = buildDirRelease
    buildMode = buildModeRelease

colorama.init()

outEncoding = &quot;cp866&quot;

spaces = &quot;    &quot;

def enqueue_output(out, queue):
    for line in iter(out.readline, b''):
        queue.put(line)
    out.close()

outFile = open(logFile,&quot;wb&quot;)

def RunCommand(strCommand):
    cmd = subprocess.Popen(strCommand, shell=True, bufsize=1, stdout=subprocess.PIPE, stderr=subprocess.PIPE)
    q = Queue()
    t = Thread(target=enqueue_output, args=(cmd.stdout, q))
    t.start()

    while True:
        code = cmd.poll()
        try:
            line = q.get_nowait()
        except Empty:
            pass
            #skip
        else:
            outFile.write(line)
            text = line.decode(outEncoding)
            if text.find(&quot;error &quot;) != -1 :
                print(text)
        if (code != None):
            break

    outFile.flush()
    resultStr = &quot;&quot;
    if code != 0:
        for line in cmd.stderr:
            text = line.decode(outEncoding)
            resultStr += &quot;\n&quot; + spaces + spaces + text

    return code == 0, resultStr

def DoCommand(strName, strCommand):
    print(strName + &quot;\n&quot;)
    ok, resStr = RunCommand(strCommand)
    if ok:
        print(spaces + Fore.GREEN + &quot;Done&quot;)
    else:
        print(spaces + Fore.RED + &quot;Failed: &quot; + strCommand)
        print(resStr)

        cont = False
        answer = raw_input('Continue?[y/n]:')
        if answer.lower() == &quot;n&quot;:
            exit(1)

    print(Fore.RESET + Back.RESET + Style.RESET_ALL)

DoCommand(&quot;Clear binaries&quot;, &quot;rmdir /s /q \&quot;&quot; + buildDir + &quot;\\&quot; + binaryDir + &quot;\&quot;&quot;)
DoCommand(&quot;SVN clear&quot;, &quot;\&quot;C:\\Program Files\\TortoiseSVN\\bin\\TortoiseProc.exe\&quot; /command:cleanup /path:\&quot;&quot; + buildDir + &quot;\&quot; /noui /delunversioned /delignored&quot;)
DoCommand(&quot;Creating bin directory&quot;, &quot;mkdir \&quot;&quot; + buildDir + &quot;\\&quot; + binaryDir + &quot;\&quot;&quot;)

for s in solutions:
    DoCommand(&quot;Compile  - &quot; + s, devenv + &quot; \&quot;&quot; + buildDir + &quot;\\&quot; + codeDir + &quot;\\&quot; + s + &quot;\&quot;&quot; + &quot; /rebuild \&quot;&quot; + buildMode + &quot;|x64\&quot;&quot;)

raw_input('Press any key to finish')
</pre>

            </div>
            <!-- /.entry-content -->
        </article>
    </section>

        </div>
        <div class="col-lg-3 well well-sm" id="sidebar">
<aside>
    <section>
        <ul class="list-group list-group-flush">
                <li class="list-group-item"><h4><i class="icon-home icon-large"></i>Social</h4></li>
                    <li class="list-group-item"><a href="https://www.google.com/+KirillKolodyazhniy"><i
                            class="icon-google-plus-sign icon-large"></i>google-plus
                    </a></li>
                    <li class="list-group-item"><a href="https://github.com/Kolkir"><i
                            class="icon-github-sign icon-large"></i>github
                    </a></li>
                    <li class="list-group-item"><a href="http://ua.linkedin.com/pub/kirill-kolodyazhniy/14/969/79b/"><i
                            class="icon-linkedin-sign icon-large"></i>linkedin
                    </a></li>



            <li class="list-group-item"><a href="./tags.html"><h4><i class="icon-tags icon-large"></i>Tags</h4></a></li>
                <li class="list-group-item tag-1">
                    <a href="./tag/multithreading.html">
                        Multithreading
                    </a>
                </li>
                <li class="list-group-item tag-1">
                    <a href="./tag/c11.html">
                        C++11
                    </a>
                </li>
                <li class="list-group-item tag-4">
                    <a href="./tag/cpptask.html">
                        CppTask
                    </a>
                </li>
                <li class="list-group-item tag-4">
                    <a href="./tag/c.html">
                        C++
                    </a>
                </li>
                <li class="list-group-item tag-4">
                    <a href="./tag/unittesting.html">
                        UnitTesting
                    </a>
                </li>
                <li class="list-group-item tag-4">
                    <a href="./tag/scanner.html">
                        Scanner
                    </a>
                </li>
                <li class="list-group-item tag-4">
                    <a href="./tag/overflow.html">
                        Overflow
                    </a>
                </li>
                <li class="list-group-item tag-4">
                    <a href="./tag/stream.html">
                        stream
                    </a>
                </li>
                <li class="list-group-item tag-4">
                    <a href="./tag/parsing.html">
                        parsing
                    </a>
                </li>
                <li class="list-group-item tag-4">
                    <a href="./tag/calibration.html">
                        calibration
                    </a>
                </li>
                <li class="list-group-item tag-4">
                    <a href="./tag/laser.html">
                        Laser
                    </a>
                </li>
        </ul>
    </section>
</aside>        </div>
    </div>
</div>

<!-- Include all compiled plugins (below), or include individual files as needed -->
<script src="./theme/js/bootstrap.min.js"></script>

<!-- Enable responsive features in IE8 with Respond.js (https://github.com/scottjehl/Respond) -->
<script src="./theme/js/respond.min.js"></script>
</body>
</html>